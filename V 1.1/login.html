<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Medsev - Healthcare Clinic</title>
    
    <link rel="shortcut icon" href="images/favicon.png" type="image/x-icon">
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
  
<!-- start nav -->
<nav class="header">
    <div id="navbar">
        <nav class="navbar navbar-expand-lg">
            <div class="container">
                <a class="navbar-brand" href="index.html"><img src="images/logo.png" alt=""></a>
                <button class="navbar-toggler btn" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="icon">
                        <svg viewBox="0 0 175 80" width="45" height="35">
                            <rect width="80" height="15" fill="#f0f0f0" rx="10"></rect>
                            <rect y="30" width="80" height="15" fill="#f0f0f0" rx="10"></rect>
                            <rect y="60" width="80" height="15" fill="#f0f0f0" rx="10"></rect>
                        </svg>
                    </span>
                </button>
                <div class="collapse navbar-collapse" id="navbarSupportedContent">
                    <ul class="navbar-nav m-auto mb-2 mb-lg-0">
                        <li class="nav-item">
                            <a class="nav-link active" aria-current="page" href="index.html">Home</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#">About</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="sick profile.html">Profile</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="contactus.html">Contact Us</a>
                        </li>
                    </ul>
                    <div class="navbar__log">
                        <a href="login.html"><i class="fa-regular fa-user"></i> <span id="login-text">LOGIN</span></a>
                    </div>
                </div>
            </div>
        </nav>
    </div>
</nav>
<!-- end nav -->

<!-- start login -->
<section class="login">
    <div class="container-fluid">
        <div class="row">
            <div class="col-lg-6">
                <div class="login__img">
                    <img src="images/login-bg.jpg" alt="">
                </div>
            </div>
            <div class="col-lg-6">
                <div class="login__form">
                    <h2>Login Here</h2>
                    <p>Didn't you account yet?<a href="sign up.html">Register Here</a></p>
                    <form id="loginForm">
                        <div class="row d-flex justify-content-center">
                            <div class="col-sm-9">
                                <input type="email" name="email" placeholder="Your Email" id="emailLogin" required>
                            </div>
                            <div class="col-sm-9">
                                <input type="password" name="password" placeholder="Password" id="passwordLogin" required>
                            </div>
                            <div class="col-sm-9">
                                <p><a href="forget password.html">Forgot Password?</a></p>
                            </div>
                            <div class="col-sm-9 text-center">
                                <button type="submit" class="btn1" id="btnLogin">Login</button>
                            </div>
                        </div>
                    </form>
                    <script>
                      document.getElementById('loginForm').addEventListener('submit', function(event) {
                          event.preventDefault();
                      
                          const email = document.getElementById('emailLogin').value;
                          const password = document.getElementById('passwordLogin').value;
                      
                          const formdata = new FormData();
                          formdata.append("email", email);
                          formdata.append("password", password);
                      
                          const requestOptions = {
                              method: "POST",
                              body: formdata,
                              redirect: "follow"
                          };
                      
                          fetch("https://apis-amirican-university.quickly-egypt.com/public/api/auth/login", requestOptions)
                              .then(response => response.json())
                              .then(result => {
                                  if (result.data) {
                                      console.log("Login successful:", result);
                                      const userData = {
                                          id: result.data.id,
                                          name: result.data.name,
                                          email: result.data.email,
                                          token: result.data.token,
                                          created_at: result.data.created_at
                                      };
                      
                                      // تخزين البيانات في Local Storage بعد النجاح في تسجيل الدخول
                                      localStorage.setItem('userData', JSON.stringify(userData));
                      
                                      alert(`Welcome back ${userData.name} 😊!`);
                      
                                      // إعادة التوجيه إلى index doctor.html
                                      window.location.href = "index doctor.html";
                                  } else {
                                      console.error("Login failed:", result);
                                      alert("Login failed: The Email or Password is incorrect.");
                                  }
                              })
                              .catch(error => {
                                  console.error("Error:", error);
                                  alert("An error occurred. Please try again.");
                              });
                      });
                      </script>
                </div>
            </div>
        </div>
    </div>
</section>
<!-- end login -->

<!-- start footer -->
<footer class="footerbig">
    <div class="footer">
        <div class="container">
            <div class="row">
                <div class="col-lg-4 col-sm-6">
                    <div class="footer__list">
                        <h2>Contact Us</h2>
                        <ul>
                            <li>
                                <i class="fa-solid fa-envelope"></i>
                                <p>
                                    <a href="#">info@medisev.com</a>
                                    <a href="#">hello@medisev.com</a>
                                </p>
                            </li>
                            <li>
                                <i class="fa-solid fa-mobile-screen"></i>
                                <p>
                                    <a href="#">Call: +07 554 332 322</a>
                                    <a href="#">Call: +236 256 256 365</a>
                                </p>
                            </li>
                            <li>
                                <i class="fa-solid fa-location-dot"></i>
                                <p>
                                    15 6'october, Hosary Street,
                                    <br> cairo egypt
                                </p>
                            </li>
                        </ul>
                    </div>
                </div>

                <div class="col-lg-2 col-sm-6">
                    <div class="footer__list">
                        <h2>Quick Links</h2>
                        <ul>
                            <li><a href="#">About us</a></li>
                            <li><a href="#">Blog</a></li>
                            <li><a href="#">Our Expertise</a></li>
                            <li><a href="#">Faq</a></li>
                            <li><a href="#">Doctors</a></li>
                            <li><a href="#">Contact us</a></li>
                        </ul>
                    </div>
                </div>

                <div class="col-lg-3 col-sm-6">
                    <div class="footer__list">
                        <h2>Our Services</h2>
                        <ul>
                            <li><a href="#">Dental Care</a></li>
                            <li><a href="#">Cardiology</a></li>
                            <li><a href="#">Hijama Therapy</a></li>
                            <li><a href="#">Massage Therapy</a></li>
                            <li><a href="#">Ambulance Services</a></li>
                            <li><a href="#">Medicine</a></li>
                        </ul>
                    </div>
                </div>

                <div class="col-lg-3 col-sm-6">
                    <div class="footer__list">
                        <h2>Feedback</h2>
                        <form action="" class="footer__form">
                            <ul>
                                <li>
                                    <input type="text" name="textfooter" id="textfooter" placeholder="Name">
                                </li>
                                <li>
                                    <input type="text" name="textnumber" id="textnumber" placeholder="Phone">
                                </li>
                                <li>
                                    <textarea name="textarea" id="textarea" cols="20" rows="10" placeholder="Message"></textarea>
                                </li>
                                <li>
                                    <button type="submit" id="btn1">Submit</button>
                                </li>
                            </ul>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
</footer>
<!-- end footer -->

<!-- JS Scripts -->
<script src="js/bootstrap.bundle.min.js"></script>
<script src="js/doctor.js"></script>
<script src="js/main.js"></script>
<script>
  document.addEventListener('DOMContentLoaded', function() {
      const navbarLog = document.querySelector('.navbar__log');
      const userData = JSON.parse(localStorage.getItem('userData'));
  
      if (userData && userData.name) {
        navbarLog.innerHTML = `
            <div class="dropdown">
                <button class="dropdown-toggle" type="button" id="dropdownMenuButton" data-bs-toggle="dropdown" aria-expanded="false">
                    <i class="fa-regular fa-user"></i> ${userData.name}
                </button>
                <ul class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                    <li><a class="dropdown-item" href="#" id="logoutBtn">Logout</a></li>
                </ul>
            </div>
        `;
        window.location.href = "index.html";

            } else {
          navbarLog.innerHTML = '<a href="login.html"><i class="fa-regular fa-user"></i> <span>LOGIN</span></a>';
      }
      const logoutBtn = document.getElementById('logoutBtn');
    if (logoutBtn) {
        logoutBtn.addEventListener('click', function(event) {
            event.preventDefault();
            localStorage.removeItem('userData');
            // إعادة التوجيه إلى صفحة تسجيل الدخول بعد تسجيل الخروج
            window.location.href = "login.html";
        });
    }
});
</script>
  </script>
  
</body>
</html>
